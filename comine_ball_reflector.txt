--@name Comine Ball Reflector
--@author PrikolMen#3372
--@server

local ply = owner()

local delay = 0
hook.add("Tick", "", function()
    local time = timer.curtime()
    if delay > time then return end
    delay = time + 0.05

    for _, ent in ipairs(find.inSphere(ply:getEyePos(), 128)) do
        if (ent:getOwner() == owner) or ent:isWeapon() then continue end
        local class = ent:getClass()
        if (class == "prop_combine_ball") or (class == "rpg_missile") then
            local ang = ent:getAngles() - ply:getAngles()
            local prop = prop.create(ent:localToWorld(ang:getForward() * 5), Angle(0, ang[2] - 90, 90), "models/hunter/plates/plate075x075.mdl", true)
    
            timer.simple(0, function()
                if isValid(prop) then
                    prop:remove()
                end
            end)
        end
    end
end)